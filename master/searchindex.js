Search.setIndex({"docnames": ["checkpointing", "distributed", "examples", "framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "overview", "utils/generated/torchtnt.utils.data.AbstractRandomDataset", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher", "utils/generated/torchtnt.utils.data.InOrderIterator", "utils/generated/torchtnt.utils.data.MultiDataLoader", "utils/generated/torchtnt.utils.data.MultiIterator", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator", "utils/generated/torchtnt.utils.data.RoundRobinIterator", "utils/generated/torchtnt.utils.device.copy_data_to_device", "utils/generated/torchtnt.utils.device.get_device_from_env", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats", "utils/generated/torchtnt.utils.device.record_data_in_stream", "utils/generated/torchtnt.utils.device.set_float32_precision", "utils/generated/torchtnt.utils.distributed.PGWrapper", "utils/generated/torchtnt.utils.distributed.all_gather_tensors", "utils/generated/torchtnt.utils.distributed.barrier", "utils/generated/torchtnt.utils.distributed.destroy_process_group", "utils/generated/torchtnt.utils.distributed.get_file_init_method", "utils/generated/torchtnt.utils.distributed.get_global_rank", "utils/generated/torchtnt.utils.distributed.get_local_rank", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method", "utils/generated/torchtnt.utils.distributed.get_world_size", "utils/generated/torchtnt.utils.distributed.rank_zero_fn", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm", "utils/generated/torchtnt.utils.distributed.spawn_multi_process", "utils/generated/torchtnt.utils.distributed.sync_bool", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker", "utils/generated/torchtnt.utils.env.init_from_env", "utils/generated/torchtnt.utils.env.seed", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode", "utils/generated/torchtnt.utils.fsspec.get_filesystem", "utils/generated/torchtnt.utils.loggers.CSVLogger", "utils/generated/torchtnt.utils.loggers.FileLogger", "utils/generated/torchtnt.utils.loggers.InMemoryLogger", "utils/generated/torchtnt.utils.loggers.JSONLogger", "utils/generated/torchtnt.utils.loggers.MetricLogger", "utils/generated/torchtnt.utils.loggers.StdoutLogger", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger", "utils/generated/torchtnt.utils.memory.RSSProfiler", "utils/generated/torchtnt.utils.memory.measure_rss_deltas", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "utils/generated/torchtnt.utils.misc.days_to_secs", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats", "utils/generated/torchtnt.utils.module_summary.ModuleSummary", "utils/generated/torchtnt.utils.module_summary.get_module_summary", "utils/generated/torchtnt.utils.module_summary.get_summary_table", "utils/generated/torchtnt.utils.module_summary.prune_module_summary", "utils/generated/torchtnt.utils.oom.attach_oom_observer", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error", "utils/generated/torchtnt.utils.oom.log_memory_snapshot", "utils/generated/torchtnt.utils.optimizer.init_optim_state", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp", "utils/generated/torchtnt.utils.prepare_module.prepare_module", "utils/generated/torchtnt.utils.progress.Progress", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn", "utils/generated/torchtnt.utils.stateful.MultiStateful", "utils/generated/torchtnt.utils.stateful.Stateful", "utils/generated/torchtnt.utils.swa.AveragedModel", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config", "utils/generated/torchtnt.utils.test_utils.is_asan", "utils/generated/torchtnt.utils.test_utils.is_tsan", "utils/generated/torchtnt.utils.test_utils.skip_if_asan", "utils/generated/torchtnt.utils.timer.BoundedTimer", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer", "utils/generated/torchtnt.utils.timer.Timer", "utils/generated/torchtnt.utils.timer.TimerProtocol", "utils/generated/torchtnt.utils.timer.get_durations_histogram", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram", "utils/generated/torchtnt.utils.timer.get_timer_summary", "utils/generated/torchtnt.utils.timer.log_elapsed_time", "utils/generated/torchtnt.utils.tqdm.close_progress_bar", "utils/generated/torchtnt.utils.tqdm.create_progress_bar", "utils/generated/torchtnt.utils.tqdm.update_progress_bar", "utils/generated/torchtnt.utils.version.get_python_version", "utils/generated/torchtnt.utils.version.get_torch_version", "utils/generated/torchtnt.utils.version.is_windows", "utils/utils"], "filenames": ["checkpointing.rst", "distributed.rst", "examples.rst", "framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "overview.rst", "utils/generated/torchtnt.utils.data.AbstractRandomDataset.rst", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator.rst", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher.rst", "utils/generated/torchtnt.utils.data.InOrderIterator.rst", "utils/generated/torchtnt.utils.data.MultiDataLoader.rst", "utils/generated/torchtnt.utils.data.MultiIterator.rst", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator.rst", "utils/generated/torchtnt.utils.data.RoundRobinIterator.rst", "utils/generated/torchtnt.utils.device.copy_data_to_device.rst", "utils/generated/torchtnt.utils.device.get_device_from_env.rst", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats.rst", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats.rst", "utils/generated/torchtnt.utils.device.record_data_in_stream.rst", "utils/generated/torchtnt.utils.device.set_float32_precision.rst", "utils/generated/torchtnt.utils.distributed.PGWrapper.rst", "utils/generated/torchtnt.utils.distributed.all_gather_tensors.rst", "utils/generated/torchtnt.utils.distributed.barrier.rst", "utils/generated/torchtnt.utils.distributed.destroy_process_group.rst", "utils/generated/torchtnt.utils.distributed.get_file_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_global_rank.rst", "utils/generated/torchtnt.utils.distributed.get_local_rank.rst", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device.rst", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_world_size.rst", "utils/generated/torchtnt.utils.distributed.rank_zero_fn.rst", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm.rst", "utils/generated/torchtnt.utils.distributed.spawn_multi_process.rst", "utils/generated/torchtnt.utils.distributed.sync_bool.rst", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker.rst", "utils/generated/torchtnt.utils.env.init_from_env.rst", "utils/generated/torchtnt.utils.env.seed.rst", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode.rst", "utils/generated/torchtnt.utils.fsspec.get_filesystem.rst", "utils/generated/torchtnt.utils.loggers.CSVLogger.rst", "utils/generated/torchtnt.utils.loggers.FileLogger.rst", "utils/generated/torchtnt.utils.loggers.InMemoryLogger.rst", "utils/generated/torchtnt.utils.loggers.JSONLogger.rst", "utils/generated/torchtnt.utils.loggers.MetricLogger.rst", "utils/generated/torchtnt.utils.loggers.StdoutLogger.rst", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger.rst", "utils/generated/torchtnt.utils.memory.RSSProfiler.rst", "utils/generated/torchtnt.utils.memory.measure_rss_deltas.rst", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler.rst", "utils/generated/torchtnt.utils.misc.days_to_secs.rst", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats.rst", "utils/generated/torchtnt.utils.module_summary.ModuleSummary.rst", "utils/generated/torchtnt.utils.module_summary.get_module_summary.rst", "utils/generated/torchtnt.utils.module_summary.get_summary_table.rst", "utils/generated/torchtnt.utils.module_summary.prune_module_summary.rst", "utils/generated/torchtnt.utils.oom.attach_oom_observer.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error.rst", "utils/generated/torchtnt.utils.oom.log_memory_snapshot.rst", "utils/generated/torchtnt.utils.optimizer.init_optim_state.rst", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype.rst", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_module.rst", "utils/generated/torchtnt.utils.progress.Progress.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn.rst", "utils/generated/torchtnt.utils.stateful.MultiStateful.rst", "utils/generated/torchtnt.utils.stateful.Stateful.rst", "utils/generated/torchtnt.utils.swa.AveragedModel.rst", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config.rst", "utils/generated/torchtnt.utils.test_utils.is_asan.rst", "utils/generated/torchtnt.utils.test_utils.is_tsan.rst", "utils/generated/torchtnt.utils.test_utils.skip_if_asan.rst", "utils/generated/torchtnt.utils.timer.BoundedTimer.rst", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer.rst", "utils/generated/torchtnt.utils.timer.Timer.rst", "utils/generated/torchtnt.utils.timer.TimerProtocol.rst", "utils/generated/torchtnt.utils.timer.get_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table.rst", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram.rst", "utils/generated/torchtnt.utils.timer.get_timer_summary.rst", "utils/generated/torchtnt.utils.timer.log_elapsed_time.rst", "utils/generated/torchtnt.utils.tqdm.close_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.create_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.update_progress_bar.rst", "utils/generated/torchtnt.utils.version.get_python_version.rst", "utils/generated/torchtnt.utils.version.get_torch_version.rst", "utils/generated/torchtnt.utils.version.is_windows.rst", "utils/utils.rst"], "titles": ["Checkpointing", "Distributed training", "Examples", "AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "GarbageCollector", "IterationTimeLogger", "Lambda", "LearningRateMonitor", "MemorySnapshot", "ModuleSummary", "PyTorchProfiler", "SystemResourcesMonitor", "TQDMProgressBar", "TensorBoardParameterMonitor", "TimeLimitInterrupter", "TorchSnapshotSaver", "TrainProgressMonitor", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Overview", "torchtnt.utils.data.AbstractRandomDataset", "torchtnt.utils.data.AllDatasetBatchesIterator", "torchtnt.utils.data.CudaDataPrefetcher", "torchtnt.utils.data.InOrderIterator", "torchtnt.utils.data.MultiDataLoader", "torchtnt.utils.data.MultiIterator", "torchtnt.utils.data.RandomizedBatchSamplerIterator", "torchtnt.utils.data.RoundRobinIterator", "torchtnt.utils.device.copy_data_to_device", "torchtnt.utils.device.get_device_from_env", "torchtnt.utils.device.get_nvidia_smi_gpu_stats", "torchtnt.utils.device.get_psutil_cpu_stats", "torchtnt.utils.device.record_data_in_stream", "torchtnt.utils.device.set_float32_precision", "torchtnt.utils.distributed.PGWrapper", "torchtnt.utils.distributed.all_gather_tensors", "torchtnt.utils.distributed.barrier", "torchtnt.utils.distributed.destroy_process_group", "torchtnt.utils.distributed.get_file_init_method", "torchtnt.utils.distributed.get_global_rank", "torchtnt.utils.distributed.get_local_rank", "torchtnt.utils.distributed.get_process_group_backend_from_device", "torchtnt.utils.distributed.get_tcp_init_method", "torchtnt.utils.distributed.get_world_size", "torchtnt.utils.distributed.rank_zero_fn", "torchtnt.utils.distributed.revert_sync_batchnorm", "torchtnt.utils.distributed.spawn_multi_process", "torchtnt.utils.distributed.sync_bool", "torchtnt.utils.early_stop_checker.EarlyStopChecker", "torchtnt.utils.env.init_from_env", "torchtnt.utils.env.seed", "torchtnt.utils.flops.FlopTensorDispatchMode", "torchtnt.utils.fsspec.get_filesystem", "torchtnt.utils.loggers.CSVLogger", "torchtnt.utils.loggers.FileLogger", "torchtnt.utils.loggers.InMemoryLogger", "torchtnt.utils.loggers.JSONLogger", "torchtnt.utils.loggers.MetricLogger", "torchtnt.utils.loggers.StdoutLogger", "torchtnt.utils.loggers.TensorBoardLogger", "torchtnt.utils.memory.RSSProfiler", "torchtnt.utils.memory.measure_rss_deltas", "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "torchtnt.utils.misc.days_to_secs", "torchtnt.utils.misc.transfer_batch_norm_stats", "torchtnt.utils.module_summary.ModuleSummary", "torchtnt.utils.module_summary.get_module_summary", "torchtnt.utils.module_summary.get_summary_table", "torchtnt.utils.module_summary.prune_module_summary", "torchtnt.utils.oom.attach_oom_observer", "torchtnt.utils.oom.is_out_of_cpu_memory", "torchtnt.utils.oom.is_out_of_cuda_memory", "torchtnt.utils.oom.is_out_of_memory_error", "torchtnt.utils.oom.log_memory_snapshot", "torchtnt.utils.optimizer.init_optim_state", "torchtnt.utils.precision.convert_precision_str_to_dtype", "torchtnt.utils.prepare_module.DDPStrategy", "torchtnt.utils.prepare_module.FSDPStrategy", "torchtnt.utils.prepare_module.convert_str_to_strategy", "torchtnt.utils.prepare_module.prepare_ddp", "torchtnt.utils.prepare_module.prepare_fsdp", "torchtnt.utils.prepare_module.prepare_module", "torchtnt.utils.progress.Progress", "torchtnt.utils.progress.estimated_steps_in_epoch", "torchtnt.utils.progress.estimated_steps_in_fit", "torchtnt.utils.progress.estimated_steps_in_loop", "torchtnt.utils.rank_zero_log.rank_zero_critical", "torchtnt.utils.rank_zero_log.rank_zero_debug", "torchtnt.utils.rank_zero_log.rank_zero_error", "torchtnt.utils.rank_zero_log.rank_zero_info", "torchtnt.utils.rank_zero_log.rank_zero_print", "torchtnt.utils.rank_zero_log.rank_zero_warn", "torchtnt.utils.stateful.MultiStateful", "torchtnt.utils.stateful.Stateful", "torchtnt.utils.swa.AveragedModel", "torchtnt.utils.test_utils.get_pet_launch_config", "torchtnt.utils.test_utils.is_asan", "torchtnt.utils.test_utils.is_tsan", "torchtnt.utils.test_utils.skip_if_asan", "torchtnt.utils.timer.BoundedTimer", "torchtnt.utils.timer.FullSyncPeriodicTimer", "torchtnt.utils.timer.Timer", "torchtnt.utils.timer.TimerProtocol", "torchtnt.utils.timer.get_durations_histogram", "torchtnt.utils.timer.get_recorded_durations_table", "torchtnt.utils.timer.get_synced_durations_histogram", "torchtnt.utils.timer.get_synced_timer_histogram", "torchtnt.utils.timer.get_timer_summary", "torchtnt.utils.timer.log_elapsed_time", "torchtnt.utils.tqdm.close_progress_bar", "torchtnt.utils.tqdm.create_progress_bar", "torchtnt.utils.tqdm.update_progress_bar", "torchtnt.utils.version.get_python_version", "torchtnt.utils.version.get_torch_version", "torchtnt.utils.version.is_windows", "Utils"], "terms": {"torchtnt": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26], "offer": [0, 1, 3, 4, 19, 24, 26], "via": [0, 34], "torchsnapshotsav": 0, "which": [0, 1, 3, 4, 5, 6, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 29, 31, 35, 39, 40, 52, 54, 55, 68, 69, 86, 87, 88, 106, 108, 114], "us": [0, 1, 2, 3, 4, 5, 6, 12, 13, 14, 18, 19, 21, 22, 23, 24, 26, 29, 33, 38, 39, 40, 41, 43, 45, 46, 47, 49, 50, 51, 53, 54, 56, 57, 59, 66, 73, 81, 85, 88, 101, 112, 113, 117, 122], "torchsnapshot": [0, 19], "under": [0, 19, 24], "hood": 0, "modul": [0, 1, 3, 5, 6, 13, 17, 21, 23, 24, 25, 26, 52, 57, 58, 71, 72, 73, 75, 84, 86, 87, 88, 99, 101], "nn": [0, 1, 3, 24, 26, 52, 86, 87, 99], "linear": [0, 1, 26, 52, 86, 87], "input_dim": [0, 1], "1": [0, 1, 6, 8, 9, 16, 18, 26, 28, 29, 30, 33, 34, 50, 51, 54, 55, 57, 58, 65, 73, 74, 75, 86, 87, 120], "unit": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 25, 26], "myunit": [0, 10, 24, 26], "tss": 0, "dirpath": [0, 19], "your_dirpath_her": 0, "save_every_n_train_step": [0, 19], "100": [0, 27, 52, 60, 63, 110, 112, 113], "save_every_n_epoch": [0, 19], "2": [0, 3, 18, 28, 29, 30, 33, 34, 54, 57, 65, 74], "load": [0, 1, 19, 29, 81, 100], "latest": [0, 25], "exist": [0, 19, 81], "latest_checkpoint_dir": 0, "restore_from_latest": 0, "train_dataload": [0, 4, 6, 19, 23, 26, 91], "dataload": [0, 3, 5, 6, 10, 19, 21, 22, 23, 24, 26, 28, 29, 30, 31, 32, 33, 34, 69, 90, 92, 117], "train": [0, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 66, 69, 91, 102, 107, 122], "callback": [0, 1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 25], "There": [0, 19, 26], "built": [0, 26], "support": [0, 3, 28, 30, 31, 32, 34, 36, 54, 73], "save": [0, 7, 12, 19, 69, 76, 80, 99, 100], "distribut": [0, 8, 16, 19, 25, 26, 36, 56, 66, 85, 102], "ddp": [0, 1, 3, 26, 83, 86, 88], "fsdp": [0, 1, 3, 19, 26, 87, 88, 101], "The": [0, 1, 2, 3, 5, 6, 7, 8, 13, 18, 19, 21, 23, 24, 26, 27, 35, 39, 40, 45, 52, 54, 56, 58, 65, 67, 68, 69, 73, 75, 76, 80, 101, 102, 106, 108, 110, 112, 113, 117], "state": [0, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 24, 25, 26, 51, 81], "dict": [0, 13, 19, 28, 30, 31, 37, 38, 67, 81, 99, 110, 111, 112, 113], "type": [0, 13, 19, 24, 26, 27, 31, 37, 38, 42, 51, 56, 72], "can": [0, 1, 2, 3, 4, 5, 6, 8, 18, 19, 21, 22, 23, 24, 25, 26, 29, 30, 32, 33, 34, 51, 66, 69, 122], "specifi": [0, 12, 16, 18, 24, 26, 54, 69, 85, 101, 117], "fsdpstrategi": [0, 1, 3, 85, 87], "s": [0, 2, 3, 5, 6, 8, 19, 21, 23, 24, 31, 54, 56, 73, 113], "state_dict_typ": [0, 84], "argument": [0, 1, 3, 5, 6, 21, 23, 35, 66, 73, 101], "like": [0, 1, 3, 19, 32, 39, 81, 101], "so": [0, 1, 3, 25, 65, 69, 117], "fsdp_strategi": [0, 1], "set": [0, 1, 5, 6, 15, 19, 21, 23, 28, 33, 36, 40, 47, 55, 56, 57, 65, 67, 68, 69, 74, 80, 86, 87, 88, 106, 108, 115], "sharded_state_dict": 0, "prepare_fsdp": [0, 1], "strategi": [0, 1, 3, 26, 34, 83, 84, 85, 86, 87, 88], "Or": 0, "you": [0, 1, 3, 19, 24, 25, 73], "manual": [0, 26], "thi": [0, 1, 3, 4, 6, 7, 8, 12, 18, 19, 20, 24, 27, 28, 29, 30, 31, 33, 34, 36, 39, 42, 43, 49, 51, 52, 54, 55, 56, 57, 65, 66, 72, 76, 80, 81, 88, 101, 106, 108], "set_state_dict_typ": [0, 19], "statedicttyp": [0, 84], "when": [0, 1, 2, 3, 4, 7, 10, 12, 13, 18, 19, 20, 22, 28, 29, 39, 43, 55, 59, 67, 68, 76, 106, 108], "your": [0, 1, 4, 12, 24], "pass": [0, 1, 3, 4, 19, 24, 26, 31, 35, 60, 66, 73, 82, 85, 101, 110], "restoreopt": [0, 19], "avoid": [0, 39, 57, 107], "optim": [0, 3, 5, 6, 11, 21, 23, 24, 25, 26, 99, 101], "learn": [0, 3, 11, 24], "rate": [0, 3, 11, 16, 24], "schedul": [0, 3, 11, 24], "your_unit": 0, "restore_opt": [0, 19], "restore_optim": 0, "fals": [0, 1, 31, 60, 63, 69, 74, 83, 84, 88, 101, 108], "restore_lr_schedul": 0, "sometim": 0, "mai": [0, 5, 6, 19, 21, 23, 42, 81, 99], "help": [0, 1, 20], "keep": [0, 13, 19, 69, 75], "track": [0, 5, 6, 11, 18, 21, 23, 69, 89], "how": [0, 2, 3, 6, 18, 24, 28, 30, 31, 32, 33, 34], "perform": [0, 3, 5, 6, 8, 19, 21, 23, 24, 106, 108], "done": [0, 5, 6, 21, 23, 28, 34, 107], "bestcheckpointconfig": [0, 19], "param": [0, 3, 19, 83, 88, 101], "best_checkpoint_config": [0, 19], "monitored_metr": 0, "train_loss": [0, 26], "mode": [0, 5, 6, 21, 23, 55, 105], "min": [0, 55], "By": [0, 7, 8, 19, 30, 33, 39], "monitor": [0, 19, 26, 55], "expect": [0, 1], "trainunit": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 23, 26], "have": [0, 3, 19, 24, 26, 42, 52, 65, 99], "attribut": [0, 19, 27, 55, 60, 61, 62, 63, 66, 72, 83, 84, 89, 101, 106, 108, 109], "time": [0, 5, 6, 8, 9, 18, 19, 21, 22, 23, 60, 70, 72, 81, 106, 107, 108, 109, 111, 115], "cast": 0, "valu": [0, 3, 19, 28, 30, 31, 32, 33, 34, 37, 38, 42, 53, 54, 56, 57, 65, 67, 73, 92, 110, 112, 113], "float": [0, 19, 26, 37, 38, 54, 55, 90, 101, 110, 111, 112, 113], "append": [0, 68, 80], "path": [0, 7, 19, 59, 60, 61, 63, 66], "name": [0, 4, 7, 13, 19, 28, 30, 31, 32, 33, 34, 60, 65, 67, 72, 110, 112, 113, 115], "comput": [0, 3, 26, 29, 110, 112, 113], "kept": [0, 19, 106, 108], "up": [0, 8, 22, 88], "date": 0, "appropri": [0, 19, 26, 36, 59], "user": [0, 1, 3, 12, 14, 19, 22, 24, 26, 29, 69, 101], "later": 0, "restore_from_best": 0, "metric_nam": 0, "If": [0, 1, 3, 13, 18, 19, 24, 25, 36, 37, 43, 45, 49, 52, 54, 55, 56, 57, 66, 69, 73, 75, 80, 91, 101, 106, 108, 110, 112, 113, 114, 115], "d": [0, 52], "valid": [0, 19], "sai": 0, "loss": [0, 3, 24, 26, 65], "after": [0, 3, 4, 6, 7, 8, 9, 12, 14, 16, 17, 18, 19, 20, 22, 24, 26, 33, 55, 65, 66, 81, 106, 108], "each": [0, 3, 7, 8, 10, 11, 19, 22, 24, 27, 33, 42, 65, 110, 112, 113], "eval": [0, 3, 4, 5, 6, 8, 9, 10, 12, 14, 15, 16, 19, 21, 22, 24, 26, 91], "epoch": [0, 3, 4, 5, 6, 10, 11, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 90, 91, 92, 117], "dure": [0, 3, 4, 5, 6, 7, 10, 12, 19, 21, 22, 23, 89], "fit": [0, 3, 4, 19, 22, 24, 25, 26, 91], "save_every_n_eval_epoch": [0, 19], "flag": [0, 3, 19, 88], "instead": [0, 19, 46, 50, 52], "eval_loss": 0, "And": 0, "onli": [0, 3, 16, 19, 22, 36, 39, 51, 54, 56, 60, 61, 63, 66, 73, 76, 80, 81, 93, 94, 95, 96, 97, 98, 99, 101], "top": [0, 19, 25, 26], "three": [0, 24, 26, 28], "keep_last_n_checkpoint": [0, 19], "3": [0, 22, 28, 30, 33, 34, 54, 58, 119], "core": [1, 3, 24], "tnt": [1, 2, 25, 26], "framework": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 27, 122], "make": [1, 8, 12, 25, 54, 65], "assumpt": 1, "about": [1, 3, 22, 24, 39], "devic": [1, 3, 25, 26, 29, 48, 52, 56, 76, 80, 83, 86, 87, 88, 101], "handl": [1, 3, 26, 59], "configur": [1, 3, 8, 19], "own": [1, 4], "As": [1, 8, 39], "conveni": [1, 3, 8, 24, 56, 89], "autounit": [1, 25, 26], "who": [1, 3, 26], "prefer": [1, 26], "automat": [1, 3, 8, 26, 49, 101], "provid": [1, 7, 18, 19, 27, 30, 31, 32, 33, 54, 80], "checkpoint": [1, 3, 4, 19, 25, 26, 81, 88, 89, 100], "model": [1, 2, 3, 4, 8, 12, 19, 24, 56, 58, 69, 71, 101], "ar": [1, 3, 4, 18, 19, 24, 25, 26, 28, 30, 31, 32, 33, 34, 42, 54, 60, 68, 69, 73, 75, 76, 80, 81, 101, 105, 110, 112, 113, 122], "evalunit": [1, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 19, 26], "predictunit": [1, 3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 19, 21, 26], "interfac": [1, 3, 7, 24, 26, 100], "initi": [1, 3, 12, 16, 19, 41, 43, 44, 45, 46, 49, 50, 54, 56, 58, 66, 67, 68, 81, 102], "cuda": [1, 5, 6, 15, 21, 23, 26, 29, 36, 39, 52, 76, 78, 80, 86, 87, 106, 108, 115], "applic": [1, 8, 19, 56], "along": [1, 110, 112, 113], "global": [1, 18, 43, 44, 45, 49, 51, 56, 57, 112, 113], "process": [1, 7, 8, 18, 19, 38, 41, 42, 43, 44, 48, 49, 53, 54, 56, 66, 102, 107, 112, 113], "group": [1, 11, 18, 19, 42, 43, 44, 48, 54, 56, 66, 112, 113], "from": [1, 3, 4, 5, 6, 10, 13, 19, 21, 23, 24, 25, 26, 28, 30, 32, 33, 37, 39, 42, 48, 51, 56, 58, 62, 65, 66, 70, 81, 93, 94, 95, 96, 97, 98, 102, 107, 110, 112, 117], "torch": [1, 3, 5, 6, 9, 14, 17, 19, 21, 23, 24, 26, 28, 29, 30, 33, 34, 35, 36, 37, 39, 40, 43, 46, 50, 52, 54, 56, 57, 58, 82, 86, 87, 88, 101, 102, 106, 108], "we": [1, 4, 8, 26, 29, 39, 73, 99, 105], "function": [1, 3, 4, 10, 13, 24, 31, 32, 35, 36, 42, 43, 45, 48, 49, 51, 52, 53, 54, 56, 57, 73, 76, 81, 97, 102, 111], "init_from_env": 1, "work": [1, 42, 81], "torchelast": 1, "should": [1, 3, 4, 6, 7, 18, 19, 24, 27, 29, 35, 51, 52, 54, 55, 66, 106, 108, 110, 112, 113], "invok": [1, 26, 43], "begin": [1, 20, 56], "script": [1, 12, 56], "simpli": 1, "wrap": [1, 43, 51, 86, 87, 101], "around": [1, 25, 26, 41], "move": [1, 9, 26, 29, 30, 86, 87, 88], "device_id": 1, "index": [1, 32, 36], "distributeddataparallel": [1, 83, 86], "also": [1, 3, 19, 25, 26, 31, 32, 36], "prepare_ddp": 1, "assist": 1, "either": [1, 3, 9, 11, 15, 17, 18, 20, 24], "string": [1, 3, 7, 18, 74, 82, 85, 88], "my_auto_unit": 1, "myautounit": 1, "dataclass": [1, 3, 28, 30, 31, 32, 33, 34, 83, 84, 85], "ddpstrategi": [1, 85, 86], "want": [1, 13, 19, 24, 26], "custom": [1, 3, 19, 24, 27, 30, 101], "ddp_strategi": 1, "broadcast_buff": [1, 83], "check_reduct": [1, 83], "true": [1, 3, 19, 54, 55, 60, 61, 63, 69, 74, 77, 78, 79, 83, 84, 86, 87, 88, 101, 106, 108, 115], "one": [1, 3, 7, 18, 24, 30, 34, 44, 52, 55, 56, 88, 99], "more": [1, 2, 3, 19, 26, 29, 31, 32, 40, 43, 45, 49, 52, 56, 57, 73, 76, 80, 101], "fullyshardeddataparallel": [1, 84, 87], "forward_prefetch": [1, 84], "limit_all_gath": [1, 84, 87], "show": 2, "basic": [2, 4, 24, 26], "It": [2, 12, 16, 18, 25, 26, 31, 51, 69, 72], "found": [2, 37], "here": [2, 24, 26, 45, 49, 56], "http": [2, 3, 12, 17, 19, 25, 29, 32, 39, 40, 45, 47, 49, 56, 57, 58, 88, 101], "github": [2, 12, 25, 101], "com": [2, 25, 101], "pytorch": [2, 3, 5, 6, 14, 17, 19, 21, 23, 25, 26, 29, 32, 39, 40, 45, 47, 49, 56, 57, 58, 73, 76, 81, 88, 101, 120], "blob": [2, 101], "master": [2, 25], "train_unit_exampl": 2, "py": [2, 101], "less": [2, 69, 75], "code": [2, 3, 4, 8, 14, 24], "featur": 2, "enabl": [2, 3, 19, 51, 57, 88, 106, 108], "out": [2, 4, 76, 101], "box": [2, 4], "auto_unit_exampl": 2, "datapip": 2, "dataloader2": [2, 5, 6, 21, 23], "torchdata_train_exampl": 2, "convnet": 2, "dataset": [2, 3, 20, 24, 27, 28, 30, 33, 34], "main": [2, 19, 25, 26, 101], "class": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 41, 55, 58, 60, 61, 62, 63, 64, 65, 66, 67, 69, 72, 83, 84, 89, 99, 100, 101, 106, 107, 108, 109], "auto_unit": 3, "arg": [3, 10, 13, 26, 35, 53, 64, 66, 93, 94, 95, 96, 97, 98, 100, 109], "kwarg": [3, 13, 35, 53, 59, 64, 66, 73, 93, 94, 95, 96, 97, 98, 100, 106, 109], "sourc": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121], "stochast": 3, "gradient": [3, 8, 26], "descent": 3, "would": 3, "data": [3, 4, 5, 6, 10, 20, 21, 23, 24, 25, 26, 35, 39, 62, 65, 88, 117], "parallel": [3, 88], "replic": [3, 19], "them": [3, 18, 26, 29, 65], "subclass": [3, 4, 6, 24, 26, 27, 31], "implement": [3, 5, 6, 7, 21, 23, 24, 26, 27, 58, 106, 108], "train_step": [3, 6, 23, 24, 26], "eval_step": [3, 5, 6, 24], "predict_step": [3, 21, 24, 26], "method": [3, 19, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 41, 45, 49, 53, 55, 56, 58, 60, 61, 62, 63, 64, 65, 66, 67, 69, 72, 83, 84, 89, 99, 100, 101, 106, 107, 108, 109], "For": [3, 18, 19, 31, 32, 40, 43, 45, 49, 56, 57, 76, 80], "run": [3, 5, 6, 8, 10, 21, 22, 23, 24, 25, 47, 73, 76, 80, 91, 103, 104, 105, 119, 120, 121], "forward": [3, 58, 72, 73], "backward": [3, 24, 26, 58, 72, 88], "step": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 26, 60, 61, 63, 65, 69, 81, 90, 91, 92, 101, 107, 117, 118], "To": [3, 4, 24, 25, 73], "benefit": 3, "must": [3, 7, 8, 18, 19, 26, 55, 56, 66, 73, 88, 101], "compute_loss": [3, 26], "configure_optimizers_and_lr_schedul": [3, 26], "addition": [3, 57], "option": [3, 4, 5, 6, 9, 10, 13, 16, 18, 19, 21, 22, 23, 24, 26, 31, 41, 42, 45, 49, 51, 52, 54, 55, 56, 57, 60, 63, 69, 70, 73, 76, 80, 82, 83, 84, 86, 87, 88, 90, 91, 92, 93, 94, 95, 96, 98, 101, 105, 108, 112, 113, 115, 117], "hook": [3, 4, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 24, 26, 83], "on_train_step_end": [3, 4, 6, 8, 9, 10, 12, 14, 16, 18, 23, 26], "on_eval_step_end": [3, 4, 5, 8, 9, 10, 12, 14, 16], "on_predict_step_end": [3, 4, 7, 8, 9, 10, 12, 14, 16, 21], "Then": [3, 24], "evalu": [3, 4, 6, 8, 10, 13, 14, 16, 19, 22, 24, 25, 26], "predict": [3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 22, 24, 25, 26], "entri": [3, 4, 19, 22, 26, 76], "point": [3, 4, 8, 22, 24, 26, 43, 65], "normal": 3, "advanc": 3, "directli": 3, "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 26, 28, 29, 30, 32, 33, 34, 35, 37, 39, 40, 42, 45, 49, 51, 52, 53, 54, 55, 56, 57, 58, 60, 61, 63, 65, 66, 68, 69, 72, 73, 74, 75, 76, 80, 81, 82, 85, 86, 87, 88, 101, 102, 106, 108, 110, 112, 113, 114, 115, 117], "step_lr_interv": 3, "whether": [3, 15, 18, 19, 22, 39, 55, 60, 72, 101, 106, 108, 115], "lr_schedul": [3, 5, 6, 21, 23, 24, 26], "everi": [3, 8, 15, 18, 19, 20, 26], "default": [3, 7, 8, 13, 15, 16, 19, 24, 27, 30, 31, 33, 39, 42, 45, 47, 48, 49, 52, 54, 56, 57, 60, 65, 67, 69, 76, 80, 85, 106, 108, 112, 113, 115, 117], "precis": [3, 25, 26, 40, 56, 65], "mix": [3, 26], "dtype": [3, 82], "accept": [3, 10, 99], "fp32": 3, "fp16": 3, "bf16": 3, "gradient_accumulation_step": [3, 26], "mani": 3, "batch": [3, 4, 10, 24, 26, 28, 29, 30, 32, 33, 34, 69, 71, 83], "accumul": [3, 26], "over": [3, 24, 26, 28, 30, 31, 32, 33, 34], "detect_anomali": 3, "anomali": [3, 26], "detect": [3, 26], "autograd": 3, "engin": 3, "org": [3, 17, 19, 29, 32, 39, 40, 45, 47, 49, 56, 57, 58, 88], "doc": [3, 17, 29, 39, 40, 45, 47, 49, 56, 57, 88], "stabl": [3, 17, 29, 39, 40, 45, 47, 49, 56, 57, 88], "html": [3, 12, 17, 19, 29, 32, 39, 40, 45, 47, 49, 56, 57, 88], "clip_grad_norm": 3, "max": [3, 5, 6, 21, 23, 55, 117], "norm": [3, 71, 83], "clip": [3, 26], "gener": [3, 4, 8, 13, 19, 31, 32, 39, 40, 57, 65, 68, 73, 74, 88, 111, 114, 115], "util": [3, 5, 6, 9, 13, 17, 19, 21, 23], "clip_grad_norm_": 3, "clip_grad_valu": 3, "clip_grad_value_": 3, "swa_param": 3, "weight": [3, 33, 101], "averag": [3, 9, 101], "torch_compile_param": [3, 88], "compil": [3, 26, 88], "activation_checkpoint_param": [3, 88], "activ": [3, 13, 22, 73, 88], "lr": [3, 26], "creat": [3, 8, 24, 26, 39, 52, 66], "enable_compiled_autograd": [3, 88], "compiled_autograd": [3, 88], "an": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19, 21, 22, 23, 24, 26, 27, 29, 31, 49, 54, 55, 65, 75, 76, 79, 82, 85, 86, 87, 88, 102, 109, 117], "experiment": [3, 88], "certain": [3, 39, 81], "through": [3, 31], "well": [3, 51, 69], "swaparam": 3, "swa": [3, 25], "shard": 3, "same": [3, 7, 8, 19, 24, 30, 31, 32, 42, 65, 71, 106], "avail": [3, 19, 36, 46, 50, 54, 56, 76, 80, 81, 106, 108, 115], "0": [3, 16, 19, 26, 28, 30, 33, 34, 46, 47, 49, 51, 54, 55, 57, 60, 61, 63, 65, 66, 83, 89, 93, 94, 95, 96, 97, 98, 101, 107, 110, 112, 113, 119, 120], "higher": 3, "abstract": [3, 24, 25, 26, 27, 61, 64], "tdata": [3, 22], "tupl": [3, 13, 24, 26, 73], "tensor": [3, 24, 26, 28, 30, 33, 34, 39, 42, 73, 81, 83], "ani": [3, 5, 6, 13, 19, 21, 23, 24, 26, 35, 53, 54, 57, 59, 66, 73, 93, 94, 95, 96, 97, 98, 106], "call": [3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 26, 35, 39, 45, 49, 51, 66, 81, 97, 106, 108], "object": [3, 5, 6, 8, 18, 21, 22, 23, 24, 28, 30, 31, 32, 33, 34, 52, 58, 73, 75, 83, 90, 91, 92, 99, 113, 114, 117], "return": [3, 24, 26, 28, 30, 33, 34, 35, 37, 38, 42, 46, 50, 51, 52, 53, 54, 56, 59, 77, 78, 79, 91, 92, 102, 110, 112, 113], "contain": [3, 19, 22, 24, 25, 26, 27, 28, 29, 31, 52, 72, 73, 82], "output": [3, 7, 16, 22, 24, 26, 65, 72, 73, 76, 80, 117], "part": [3, 26], "lrschedul": [3, 99], "construct": [3, 29, 39, 66, 117], "upon": [3, 19], "A": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 22, 28, 30, 31, 32, 33, 34, 37, 41, 49, 53, 58, 67, 68, 73, 81, 92, 106, 108, 110, 112, 113], "requir": [3, 24, 57, 58], "iter": [3, 5, 6, 9, 19, 20, 21, 22, 23, 24, 28, 29, 30, 31, 32, 33, 34, 84, 90, 91, 92, 117], "wish": [3, 24], "decor": [3, 24, 51], "inference_mod": [3, 24], "improv": [3, 8, 24, 55], "metadata": [3, 24], "get_next_eval_batch": [3, 5, 24], "data_it": [3, 24], "union": [3, 4, 7, 9, 10, 11, 15, 16, 17, 18, 19, 20, 24, 28, 30, 31, 32, 33, 34, 52, 54, 57, 83, 84, 85, 88, 99, 117], "next": [3, 4, 10, 24, 30], "input": [3, 24, 26, 30, 52, 54, 57, 72, 110, 112, 113, 114], "otherwis": [3, 8, 24, 39, 46, 50, 101], "overrid": [3, 24], "logic": [3, 4, 24, 31, 32], "get": [3, 4, 16, 24, 32, 36, 37, 38, 45, 46, 47, 48, 49, 50, 119, 120], "get_next_predict_batch": [3, 21, 24], "get_next_train_batch": [3, 6, 23, 24], "int": [3, 5, 6, 8, 9, 13, 16, 18, 19, 21, 22, 23, 26, 27, 29, 45, 46, 47, 49, 50, 53, 54, 55, 57, 60, 61, 63, 65, 68, 70, 75, 76, 83, 84, 89, 90, 91, 92, 102, 106, 116, 117, 118], "none": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 39, 40, 41, 42, 43, 44, 45, 49, 51, 52, 54, 55, 56, 57, 58, 60, 61, 62, 63, 65, 66, 67, 68, 69, 71, 72, 73, 75, 76, 80, 81, 83, 84, 86, 87, 88, 89, 91, 92, 93, 94, 95, 96, 97, 98, 99, 101, 106, 107, 108, 112, 113, 115, 116, 117, 118], "end": [3, 4, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19, 20, 22, 24, 26], "befor": [3, 4, 7, 8, 11, 12, 13, 14, 15, 16, 18, 20, 24, 58, 60, 61, 63, 69, 106, 108], "updat": [3, 8, 16, 19, 25, 26, 101, 116, 118], "log": [3, 9, 11, 13, 15, 17, 19, 20, 25, 26, 60, 61, 62, 63, 65, 66, 93, 94, 95, 96, 98, 106, 108, 115], "metric": [3, 19, 25, 26, 55, 64, 65], "do": [3, 25, 26, 65], "anyth": 3, "els": [3, 51, 60, 61, 63], "been": [3, 18, 28, 34, 56], "complet": [3, 19, 22, 117, 118], "on_train_epoch_end": [3, 4, 6, 10, 16, 17, 18, 20, 23, 24, 26], "note": [3, 12, 52, 57], "rememb": 3, "super": [3, 24, 26], "result": [3, 8, 26, 42, 54, 67, 107, 111], "trainstepresult": [3, 26], "total": [3, 19, 27, 91, 92], "autopredictunit": 3, "str": [3, 4, 7, 11, 13, 18, 19, 26, 28, 30, 31, 32, 33, 34, 37, 38, 40, 45, 48, 49, 52, 53, 54, 56, 57, 59, 60, 61, 63, 66, 69, 73, 74, 76, 80, 82, 84, 85, 88, 99, 110, 111, 112, 113, 114, 115, 117], "torchcompileparam": [3, 88], "bool": [3, 19, 22, 31, 54, 55, 60, 61, 63, 74, 77, 78, 79, 83, 84, 88, 101, 103, 104, 108, 115, 121], "tpredictdata": [3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 19, 21, 24], "extens": [4, 26], "supplement": [4, 19], "loop": [4, 5, 6, 8, 10, 18, 21, 22, 23, 24, 25, 26, 89, 92, 117], "addit": [4, 19, 24, 26, 39, 106], "good": [4, 65], "candid": 4, "ones": [4, 19], "re": [4, 58, 81], "across": [4, 7, 8, 19, 20, 43, 54, 57, 112, 113], "intend": [4, 26, 27, 56], "go": 4, "write": [4, 7, 20, 39, 60, 61, 63, 66, 80], "add": [4, 43], "below": [4, 5, 6, 21, 23, 24], "exampl": [4, 5, 6, 10, 18, 19, 21, 23, 24, 28, 29, 30, 31, 32, 33, 34, 51, 52, 53, 54, 58, 62, 65, 66, 69, 86, 87, 102, 119, 120], "print": [4, 10, 13, 15, 26, 28, 30, 33, 34, 54, 65, 74, 97], "messag": [4, 16, 79, 93, 94, 95, 96, 98, 117], "variou": [4, 25, 26], "execut": [4, 5, 6, 8, 21, 22, 23, 51, 55, 56], "import": [4, 5, 6, 8, 10, 21, 23, 24, 26, 51, 58, 62, 65, 66, 102], "tevalunit": [4, 26], "tpredictunit": [4, 26], "ttrainunit": [4, 26], "printingcallback": [4, 26], "def": [4, 10, 24, 26, 51], "on_train_start": [4, 6, 8, 10, 13, 14, 18, 19, 20, 23, 24, 26], "self": [4, 24, 26], "start": [4, 7, 8, 10, 11, 13, 14, 15, 16, 18, 19, 20, 22, 24, 26, 69, 101], "on_train_end": [4, 6, 8, 10, 14, 23, 24, 26], "on_eval_start": [4, 5, 8, 10, 13, 14, 24, 26], "on_eval_end": [4, 5, 8, 10, 14, 24, 26], "on_predict_start": [4, 7, 8, 10, 13, 14, 21, 24, 26], "on_predict_end": [4, 7, 8, 10, 14, 21, 24, 26], "instanti": [4, 12, 26, 69], "printing_callback": 4, "train_unit": [4, 23, 24], "properti": [4, 19, 22], "distinct": 4, "per": [4, 5, 6, 21, 22, 23, 65, 106, 108, 117], "instanc": [4, 5, 6, 9, 12, 17, 19, 21, 22, 23, 31, 69, 85, 86, 87, 102], "debug": [4, 22, 26, 94], "profil": [4, 14, 67, 69], "purpos": 4, "tevaldata": [4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 19, 24], "on_eval_epoch_end": [4, 5, 10, 16, 24], "on_eval_epoch_start": [4, 5, 10, 15, 16, 24], "new": [4, 11, 15, 16, 24, 45, 52, 66], "on_eval_get_next_batch_end": [4, 10], "on_eval_step_start": [4, 5, 10, 15], "on_except": [4, 7, 10, 19], "ttraindata": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 23, 24], "exc": [4, 7, 19], "baseexcept": [4, 7, 10, 19, 77, 78, 79], "except": [4, 5, 6, 7, 10, 19, 21, 23, 31, 77, 78, 79], "occur": [4, 7, 10, 19, 20, 76, 101], "on_predict_epoch_end": [4, 10, 16, 21, 24], "on_predict_epoch_start": [4, 10, 15, 16, 21, 24], "on_predict_get_next_batch_end": [4, 10], "on_predict_step_start": [4, 10, 15, 21], "on_train_epoch_start": [4, 6, 10, 11, 15, 16, 23, 24], "on_train_get_next_batch_end": [4, 10], "on_train_step_start": [4, 6, 10, 11, 15, 23], "sever": [4, 24, 26, 42], "pre": 4, "written": [4, 7, 66], "readi": 4, "eval_unit": [5, 24], "eval_dataload": [5, 6, 91], "max_steps_per_epoch": [5, 21, 22, 23, 90, 92, 117], "list": [5, 6, 7, 11, 13, 15, 19, 20, 21, 23, 42, 53, 67, 68, 110, 112], "timer": [5, 6, 21, 22, 23, 25], "timerprotocol": [5, 6, 21, 22, 23, 106, 108, 113, 114], "take": [5, 6, 8, 19, 21, 23], "modifi": [5, 6, 21, 22, 23, 24], "includ": [5, 6, 15, 21, 23, 25, 26, 32, 56, 83, 89], "etc": [5, 6, 13, 19, 21, 23, 26, 31, 32, 53], "number": [5, 6, 8, 16, 19, 21, 22, 23, 27, 29, 42, 45, 49, 53, 55, 57, 60, 61, 63, 65, 72, 76, 90, 91, 92, 101, 102, 106, 108, 117, 118], "mean": [5, 6, 21, 23, 58, 72, 110, 112, 113], "until": [5, 6, 21, 23, 28], "exhaust": [5, 6, 21, 23, 28, 30, 33, 34], "kei": [5, 6, 19, 21, 22, 23, 28, 30, 31, 32, 33, 34, 37, 38, 67], "event": [5, 6, 21, 22, 23, 66, 69, 115], "synchron": [5, 6, 8, 21, 23, 43, 45, 51, 54, 66, 106, 108, 112, 113, 115], "degrad": [5, 6, 21, 23], "myevalunit": [5, 24], "20": [5, 18, 21, 52], "pseudocod": [5, 6, 21, 23], "what": [5, 6, 19, 21, 23, 101], "doe": [5, 6, 8, 21, 23, 81], "first": [5, 6, 18, 21, 23, 25, 81], "while": [5, 6, 21, 23, 28, 34], "try": [5, 6, 21, 23], "increment": [5, 6, 21, 23], "counter": [5, 6, 21, 23, 58], "stopiter": [5, 6, 21, 23], "break": [5, 6, 21, 23], "max_epoch": [6, 22, 23, 26], "max_step": [6, 22, 23, 90, 91, 92, 117], "max_train_steps_per_epoch": [6, 91], "max_eval_steps_per_epoch": [6, 91], "evaluate_every_n_step": [6, 22], "evaluate_every_n_epoch": [6, 22], "interleav": [6, 24, 26, 29], "both": [6, 18], "limit": [6, 18, 23], "infinit": [6, 23, 55], "unless": [6, 23], "stop": [6, 18, 22, 23, 25, 28, 33, 34, 55], "often": [6, 18], "term": [6, 20, 22], "fit_unit": 6, "myfitunit": 6, "4": [6, 23, 28, 30, 33, 34, 54, 65], "header_row": 7, "dir_path": 7, "delimit": 7, "t": [7, 26, 35, 39, 57, 58, 91, 92], "filenam": [7, 45, 80], "csv": [7, 60], "file": [7, 12, 16, 45, 56, 60, 61, 63, 66, 69, 117], "simplifi": [7, 25, 26], "extend": [7, 24], "get_step_output_row": 7, "desir": [7, 51], "row": 7, "all": [7, 8, 12, 13, 19, 26, 28, 30, 32, 33, 42, 43, 52, 54, 60, 61, 63, 66, 114], "match": 7, "column": 7, "defin": [7, 18, 22, 24, 26, 31, 32, 34, 66, 86, 87, 100, 106, 108, 109], "directori": [7, 12, 19, 69, 76, 80], "where": [7, 12, 16, 19, 24, 39, 42, 53, 69, 117], "separ": 7, "tab": 7, "step_interv": 8, "period": [8, 19, 67, 68], "garbag": 8, "collect": [8, 12, 19, 41, 66, 72], "In": [8, 24, 42, 54, 55], "fulli": 8, "program": [8, 36, 39, 56, 121], "multipl": [8, 39, 40, 56, 99], "These": [8, 24, 26, 122], "need": [8, 19, 24, 26, 39, 51, 101, 122], "commun": [8, 18, 19, 49, 53, 83], "other": [8, 19, 54, 107], "especi": [8, 20], "overal": 8, "therefor": 8, "gate": 8, "slowest": 8, "roughli": 8, "amount": [8, 18], "its": [8, 39, 72, 73], "straggler": 8, "python": [8, 57, 103, 104, 119], "trigger": 8, "differ": [8, 19, 24, 25, 26, 42, 65], "possibl": [8, 12, 18], "lead": 8, "frequenc": [8, 9, 19, 22, 26], "tune": 8, "base": [8, 19, 27, 36, 56, 58, 79, 101], "hand": 8, "free": [8, 39, 49, 53, 69], "some": [8, 24, 81], "reap": 8, "minim": 8, "overhead": 8, "compar": 8, "full": 8, "cleanup": 8, "logger": [9, 11, 15, 17, 20, 25, 26, 93, 94, 95, 96, 98], "tensorboardlogg": [9, 17, 26], "summarywrit": [9, 17, 66], "moving_avg_window": 9, "log_every_n_step": [9, 26], "scalar": 9, "tensorboard": [9, 17, 26, 66], "control": [9, 12, 19, 24, 26, 57], "window": [9, 121], "callabl": [10, 13, 51, 53, 83, 84, 105], "retriev": 10, "mydataload": 10, "print_on_step_start": 10, "f": [10, 54], "eval_progress": 10, "num_steps_complet": [10, 26, 89, 90, 116, 117, 118], "lambda_cb": 10, "metriclogg": [11, 15, 20], "logging_interv": [11, 15], "associ": 11, "memory_snapshot_profil": 12, "memorysnapshotprofilerbas": 12, "memori": [12, 15, 25, 29, 39, 62, 69, 76, 80, 81], "snapshot": [12, 19, 69, 76, 80], "pickl": 12, "zdevito": 12, "io": 12, "2022": 12, "08": 12, "16": 12, "recommend": [12, 26, 29], "earli": [12, 25, 55], "ideal": [12, 58, 69], "sure": [12, 25], "alloc": [12, 39, 69, 81], "captur": [12, 67], "max_depth": [13, 75], "process_fn": 13, "module_summari": 13, "_log_module_summary_t": 13, "module_input": [13, 58], "mutablemap": [13, 73], "summari": [13, 25, 72, 75, 114], "maximum": [13, 18, 22, 75, 76], "depth": [13, 75], "tabl": 13, "map": [13, 28, 30, 32, 33, 34, 37, 38, 110, 112, 113], "flop": [13, 25, 72, 73], "size": [13, 15, 27, 42, 50, 67, 68, 72, 73], "rais": [13, 18, 31, 36, 37, 55, 57, 69, 75, 82, 85, 106, 108, 110, 112, 113, 114, 115], "runtimeerror": [13, 36], "torchev": 13, "instal": 13, "context": [14, 36, 58, 68], "manag": [14, 19, 58, 68], "liter": [15, 18, 54, 55, 56, 101], "system": [15, 45, 121], "stat": [15, 26, 37, 38], "cpu": [15, 22, 36, 38, 52, 77], "usag": 15, "resid": [15, 67, 68], "gpu": [15, 36, 37, 106, 108], "refresh_r": [16, 116, 118], "textio": [16, 117], "stringio": [16, 117], "progress": [16, 19, 20, 25, 26, 99, 116, 117, 118], "bar": [16, 116, 117, 118], "visual": [16, 20, 69], "rank": [16, 18, 19, 25, 45, 46, 47, 49, 51, 53, 54, 60, 61, 63, 65, 66, 93, 94, 95, 96, 97, 98, 102, 107, 112, 113], "environ": [16, 25, 36, 45, 47, 49, 56, 66, 120], "determin": [16, 18, 40, 55, 57, 103, 104], "sy": [16, 117], "stderr": [16, 117], "histogram": [17, 110, 112], "writer": 17, "durat": [18, 110, 111, 112, 113], "timedelta": [18, 56, 67, 68, 107], "timestamp": 18, "datetim": [18, 56, 67, 68], "interv": [18, 26, 67, 68, 107], "interval_freq": 18, "spent": 18, "reach": [18, 106, 108], "job": 18, "absolut": [18, 55], "At": 18, "least": [18, 54], "condit": [18, 46, 50], "met": [18, 46, 50], "spend": 18, "form": 18, "dd": 18, "hh": 18, "mm": 18, "dai": [18, 70], "hour": 18, "minut": [18, 56], "00": 18, "indic": [18, 19, 28, 30, 31, 32, 33, 34, 92], "even": 18, "ha": [18, 25, 26, 28, 31, 32, 34, 55, 56, 114], "yet": 18, "timezon": 18, "awar": 18, "check": [18, 55, 101], "exceed": 18, "two": [18, 25, 26, 34, 71], "valueerror": [18, 55, 57, 69, 75, 82, 85, 106, 108, 110, 112, 113, 114, 115], "i": [18, 42, 53], "e": [18, 24, 26, 74], "between": [18, 55, 71], "process_group": [19, 83, 84], "processgroup": [19, 41, 42, 54, 83, 84, 107, 112, 113], "async_checkpoint": 19, "storage_opt": 19, "knob_opt": 19, "knobopt": 19, "appstatemixin": 19, "random": [19, 27, 57], "epoch_": 19, "_step_": 19, "parent": [19, 22], "intra": 19, "most": [19, 115], "recent": 19, "excess": 19, "present": 19, "oldest": [19, 106, 108], "delet": 19, "clean": 19, "best": 19, "config": [19, 102], "n": [19, 54], "read": [19, 22, 31, 32], "off": 19, "prior": 19, "entir": 19, "world": [19, 41, 42, 50], "asynchron": [19, 60, 107], "glob": 19, "pattern": 19, "inform": [19, 22, 40, 45, 49, 52, 56, 72, 74, 76, 80], "see": [19, 26, 40, 45, 49, 56, 57, 76, 80, 101], "api_refer": 19, "safer": 19, "realli": 19, "thing": 19, "grad_scal": 19, "mark": 19, "thei": [19, 65], "unsur": 19, "leav": 19, "field": 19, "unset": 19, "keyword": [19, 35, 66], "storag": 19, "plugin": 19, "document": [19, 31, 32], "knob": 19, "constructor": 19, "oper": [19, 29, 40, 56, 57, 66, 121], "broadcast": [19, 42, 54], "state_dict": [19, 81, 89, 99], "castabl": 19, "maintain": [19, 25, 26], "accuraci": [19, 26, 62, 65, 66], "respons": 19, "reset": [19, 26, 58, 107, 109], "collis": 19, "app": [19, 41], "static": 19, "restor": [19, 81], "skip": [19, 28, 31, 34, 101, 105], "filter": 19, "vs": [20, 74], "predict_unit": [21, 24], "predict_dataload": 21, "mypredictunit": [21, 24], "entry_point": 22, "entrypoint": [22, 102], "train_stat": 22, "tstepoutput": 22, "eval_st": 22, "predict_st": 22, "phase": [22, 24], "active_phas": 22, "activephas": 22, "current": [22, 36, 54, 56, 73, 90, 92, 119, 120, 121], "One": 22, "meta": 22, "should_stop": 22, "termin": 22, "signal": [22, 55], "record": [22, 39, 69, 76, 110, 111, 112, 113, 114], "latenc": 22, "iteration_tim": 22, "alwai": 22, "without": [22, 55], "synchronis": 22, "step_output": 22, "last": 22, "mytrainunit": [23, 24], "concept": [24, 26], "repres": [24, 26, 83, 84], "primari": [24, 26], "place": [24, 26, 81], "organ": 24, "mutual": [24, 26], "exclus": [24, 26], "g": [24, 26, 74], "case": [24, 26, 42, 54], "allow": [24, 41, 101], "behavior": [24, 106], "fetch": [24, 45, 49], "simpl": [24, 62, 66], "typecheck": 24, "__init__": [24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 41, 55, 58, 60, 61, 62, 63, 64, 65, 66, 67, 69, 72, 83, 84, 89, 99, 100, 101, 106, 107, 108, 109], "_lrschedul": 24, "target": [24, 26], "binary_cross_entropy_with_logit": [24, 26], "zero_grad": [24, 26], "plan": 24, "refer": [24, 31, 32, 43], "my_unit": [24, 26], "librari": [25, 26, 57], "tool": [25, 26], "compon": [25, 26], "level": [25, 26], "repo": [25, 26], "lightweight": [25, 26], "grab": [25, 26], "bag": [25, 26], "independ": [25, 26, 122], "relat": [25, 26, 77, 78, 122], "wrapper": [25, 26, 41, 99], "publish": [25, 26], "pip": 25, "issu": [25, 41], "version": [25, 101], "just": 25, "git": 25, "upgrad": 25, "checker": 25, "filesystem": [25, 59], "spec": 25, "memorysnapshotprofil": 25, "oom": [25, 69], "prepar": 25, "zero": [25, 69, 81], "test": [25, 105], "tqdm": 25, "misc": 25, "welcom": 26, "descript": [26, 117], "immedi": 26, "infer": [26, 117], "combin": 26, "myexampleunit": 26, "_modul": 26, "_devic": 26, "_optim": 26, "_log_every_n_step": 26, "_accuraci": 26, "binaryaccuraci": 26, "_tb_logger": 26, "trainer": 26, "our": 26, "task": 26, "copy_data_to_devic": 26, "squeez": 26, "step_count": 26, "train_progress": 26, "acc": 26, "log_dict": [26, 65], "train_accuraci": 26, "train_accuracy_epoch": 26, "predictbatch": 26, "256": 26, "10": [26, 28, 30, 33, 34, 62, 66, 69], "1000": 26, "5": [26, 28, 30, 33, 34, 54, 69], "howev": 26, "don": [26, 57], "necessarili": 26, "themselv": 26, "appli": [26, 101, 106, 108], "tb_logger": 26, "multiclassaccuraci": 26, "gamma": 26, "tlrschedul": 26, "adadelta": 26, "steplr": 26, "step_siz": 26, "nll_loss": 26, "_": 26, "mechan": [26, 28, 33, 34], "inject": 26, "within": [26, 36, 57], "wai": 26, "page": 26, "detail": [26, 31, 32, 57], "suit": 26, "rang": [26, 28, 30, 33, 34, 36, 54, 57, 106, 108, 110, 112, 113], "concret": 27, "_generate_random_item": 27, "produc": 27, "singl": [27, 30, 41, 53, 73, 102], "item": [27, 28, 30, 33, 34], "titem": 27, "individual_dataload": [28, 30, 31, 32, 33, 34], "iteration_strategi": [28, 30, 31, 32, 33, 34], "alldatasetbatch": 28, "all_datasets_exhaust": [28, 33, 34], "finish": 28, "till": [28, 30, 34], "largest": [28, 34], "those": [28, 34], "smallest_dataset_exhaust": [28, 34], "onc": [28, 34, 39, 55], "smallest": [28, 34], "restart_until_all_datasets_exhaust": 28, "restart": 28, "format": [28, 30, 33, 34, 111], "dataloader_1_nam": 28, "batch_obtained_from_dataloader_1": 28, "dataloader_2_nam": 28, "batch_obtained_from_dataloader_2": 28, "loader": [28, 30, 33, 34], "batch_siz": [28, 30, 33, 34], "b": [28, 30, 33, 34], "15": [28, 30, 33, 34], "all_dataset_batch_strategi": 28, "stopping_mechan": [28, 33, 34], "stoppingmechan": [28, 33, 34], "combined_iter": [28, 30, 33, 34], "6": [28, 30, 33, 34], "7": [28, 30, 33, 34], "8": [28, 30, 33, 34, 102, 119], "9": [28, 30, 33, 34], "11": [28, 30, 33, 34], "12": [28, 30, 33, 34, 120], "13": [28, 30, 33, 34, 58, 73], "14": [28, 30, 33, 34], "data_iter": 29, "num_prefetch_batch": 29, "prefetch": 29, "host": [29, 76, 80], "copi": [29, 35, 58, 101], "effect": 29, "leverag": 29, "pin": 29, "data_prefetch": 29, "alreadi": [29, 44, 56, 101], "inord": 30, "order": [30, 32, 34, 65, 107, 115], "overridden": 30, "repetit": 30, "dataloader_nam": [30, 33, 34], "batch_from_dataload": [30, 33, 34], "randomizedbatchsampl": [30, 33], "in_order_strategi": 30, "randomizedbatchsampleriter": 30, "dataiterationstrategi": [31, 32], "iterator_cl": 31, "multiiter": 31, "ignore_empty_data": 31, "cycl": [31, 32, 34], "individu": [31, 32], "dictionari": [31, 106, 108, 110, 112, 113], "torchdata": [31, 32], "multi": [31, 32, 53, 102], "achiev": [31, 32], "mux": [31, 32], "mux_longest": [31, 32], "zip": [31, 32], "pleas": [31, 32, 43], "given": [32, 55, 59, 107, 114, 115], "accompani": 32, "particular": 32, "beta": 32, "randomli": 33, "sampl": [33, 106, 108], "chang": [33, 55], "anoth": [33, 39], "randomized_batch_sampl": 33, "roundrobin": 34, "robinrobin": 34, "round_robin_strategi": 34, "recurs": 35, "posit": [35, 66], "correct": 35, "mp": 36, "reli": [36, 81], "local_rank": [36, 47], "variabl": [36, 47, 66], "made": 36, "launcher": [36, 102], "outsid": [36, 57], "gpustat": 37, "nvidia": 37, "smi": 37, "utilization_gpu_perc": 37, "utilization_memory_perc": 37, "fan_speed_perc": 37, "memory_used_mb": 37, "memory_free_mb": 37, "temperature_gpu_celsiu": 37, "temperature_memory_celsiu": 37, "filenotfounderror": 37, "command": 37, "cpustat": 38, "psutil": 38, "cpu_vm_perc": 38, "cpu_perc": 38, "cpu_swap_perc": 38, "worker_cpu_time_us": 38, "worker_cpu_time_system": 38, "worker_rss": 38, "stream": [39, 115], "element": 39, "being": [39, 115], "reus": 39, "mention": 39, "record_stream": 39, "cach": 39, "freed": 39, "newli": 39, "trace": [39, 76], "still": 39, "wa": 39, "tell": 39, "might": [39, 99], "underli": 39, "longer": 39, "creator": 39, "notabl": 39, "trick": 39, "high": [40, 56], "float32": 40, "matrix": [40, 56], "convolut": 40, "set_float32_matmul_precis": 40, "backend": [40, 48, 53, 56], "cudnn": [40, 57], "allow_tf32": 40, "datatyp": 40, "pg": [41, 54, 112, 113], "consist": 41, "fashion": 41, "regardless": 41, "follow": [41, 56, 65, 72], "scenario": 41, "gather": 42, "onto": 42, "dimens": [42, 52], "pad": 42, "trim": 42, "secur": 42, "equal": [42, 56, 69], "workload": 42, "sync": [42, 83, 110, 112, 113], "gathered_result": 42, "correspond": 42, "granular": 43, "pgwrapper": 43, "destroi": 44, "world_siz": [45, 49, 50, 53], "init": [45, 49], "tcp": [45, 49, 56], "protocol": [45, 49, 109], "share": 45, "worker": [45, 49], "get_world_s": [45, 49], "get_global_rank": [45, 49], "temporari": 45, "env": [46, 50], "var": [46, 50], "neither": [46, 50, 69], "popul": 47, "elast": 47, "hostnam": 49, "port": [49, 53], "address": 49, "belong": [49, 65], "localhost": [49, 53], "select": 49, "fn": 51, "treturn": [51, 53, 105], "judici": 51, "never": 51, "veri": 51, "carefulli": 51, "mutat": 51, "local": 51, "foo": 51, "x": 51, "wrapped_fn": 51, "helper": [52, 111], "convert": [52, 70, 82, 85], "syncbatchnorm": 52, "layer": 52, "batchnorm": 52, "revert": 52, "convert_sync_batchnorm": 52, "origin": 52, "network": 52, "sequenti": 52, "batchnorm1d": 52, "sync_bn_modul": 52, "reverted_modul": 52, "method_arg": 53, "method_kwarg": 53, "spawn": 53, "node": [53, 102], "nccl": 53, "gloo": 53, "l": 53, "methods_kwarg": 53, "val": 54, "coherence_mod": 54, "rank_zero": 54, "boolean": 54, "member": 54, "manner": 54, "receiv": 54, "truth": 54, "integ": [54, 57, 117], "ratio": 54, "synced_v": 54, "iff": 54, "success": [54, 65], "patienc": 55, "min_delta": 55, "check_finit": 55, "threshold_mod": 55, "ab": 55, "rel": 55, "stopping_threshold": 55, "divergence_threshold": 55, "decreas": 55, "increas": 55, "minimum": 55, "qualifi": 55, "improvement_threshold": 55, "best_val": 55, "threshold": 55, "becom": 55, "nan": 55, "delta": [55, 67, 68], "beyond": 55, "wors": 55, "than": [55, 69, 75, 106, 108], "device_typ": 56, "dist_init_method_typ": 56, "pg_backend": 56, "pg_timeout": 56, "second": [56, 70], "1800": 56, "float32_matmul_precis": 56, "launch": [56, 102], "spmd": 56, "style": [56, 101], "timeout": 56, "against": 56, "30": 56, "determinist": 57, "pseudo": 57, "commonli": 57, "numpi": 57, "error": [57, 76, 79, 95], "warn": [57, 98], "nondeterminist": 57, "benchmark": 57, "disabl": 57, "set_deterministic_debug_mod": 57, "algorithm": 57, "measur": [58, 67, 68, 107, 115], "count": 58, "dev": 58, "discuss": 58, "dispatch": 58, "505": 58, "torchvis": 58, "resnet18": 58, "randn": 58, "224": 58, "ftdm": 58, "flops_forward": 58, "deepcopi": [58, 101], "flop_count": 58, "flops_backward": 58, "abstractfilesystem": 59, "steps_before_flush": [60, 61, 63], "log_all_rank": [60, 61, 63], "async_writ": 60, "header": 60, "buffer": [60, 62], "flush": [60, 61, 63], "store": [61, 63, 67, 99, 106, 108, 109], "23": [62, 66], "56": [62, 66], "close": [62, 66, 116], "json": 63, "stdout": 65, "line": 65, "were": 65, "treat": 65, "opaqu": 65, "identifi": 65, "consecut": 65, "practic": 65, "digit": 65, "decim": 65, "rule": 65, "round": [65, 67], "usual": 65, "982378": 65, "23112": 65, "payload": 65, "99123": 65, "18787": 65, "9824": 65, "2311": 65, "9912": 65, "1879": 65, "On": 66, "extra": 66, "tmp": [66, 69], "tb_log": 66, "microsecond": [67, 68], "100000": [67, 68, 69], "rss": [67, 68], "baselin": [67, 68], "rss_deltas_byt": 67, "100m": 67, "byte": [67, 68, 72], "rss_delta": 68, "output_dir": [69, 76, 80], "memory_snapshot_param": 69, "memorysnapshotparam": 69, "histori": 69, "dump": 69, "offlin": 69, "stai": 69, "constant": 69, "account": 69, "start_step": 69, "neg": 69, "stop_step": 69, "greater": [69, 73], "nor": 69, "enable_oom_observ": 69, "src_modul": 71, "dst_modul": 71, "transfer": 71, "statist": 71, "submodul": [72, 73], "trainabl": 72, "estim": [72, 90, 91, 92], "uniniti": 72, "calcul": [72, 73, 91], "shape": 72, "elaps": [72, 107, 115], "ms": 72, "module_arg": 73, "module_kwarg": 73, "modulesummari": [73, 74, 75], "assign": 73, "tree": [73, 75], "summar": 73, "lazi": 73, "NOT": 73, "todo": 73, "flexibl": [73, 101], "human_readable_num": 74, "summary_t": 74, "tabular": [74, 111], "exact": 74, "1234": 74, "k": 74, "prune": 75, "deeper": 75, "prun": 75, "inplac": 75, "root": 75, "trace_max_entri": 76, "1000000": 76, "attach": 76, "blog": [76, 80], "post": [76, 80], "due": 79, "file_prefix": 80, "prefix": 80, "memory_snapshot": 80, "grad": 81, "necessari": [81, 99], "becaus": [81, 99], "adamw": 81, "lazili": 81, "solut": 81, "ensur": [81, 101, 106, 108], "invalid": [82, 85], "output_devic": 83, "dim": 83, "bucket_cap_mb": 83, "25": 83, "find_unused_paramet": [83, 86], "gradient_as_bucket_view": [83, 86], "static_graph": 83, "comm_stat": 83, "comm_hook": 83, "gradbucket": 83, "futur": 83, "sync_batchnorm": 83, "regist": 83, "sharding_strategi": 84, "shardingstrategi": 84, "cpu_offload": 84, "cpuoffload": 84, "auto_wrap_polici": 84, "backward_prefetch": 84, "backwardprefetch": 84, "backward_pr": 84, "mixed_precis": 84, "mixedprecis": 84, "ignored_modul": 84, "param_init_fn": 84, "sync_module_st": 84, "use_orig_param": 84, "state_dict_config": 84, "statedictconfig": 84, "optim_state_dict_config": 84, "optimstatedictconfig": 84, "noopstrategi": 85, "api": [86, 87, 99], "ddp_modul": 86, "fsdp_modul": 87, "activationcheckpointparam": 88, "noop": 88, "num_epochs_complet": [89, 117], "num_steps_completed_in_epoch": 89, "load_state_dict": 89, "remain": 90, "eval_every_n_step": 91, "eval_every_n_epoch": 91, "couldn": [91, 92], "critic": 93, "info": 96, "stateful_obj": 99, "fsdpoptimizerwrapp": 99, "load_checkpoint": 99, "use_buff": 101, "averaging_method": 101, "ema": 101, "ema_decai": 101, "999": 101, "skip_deepcopi": 101, "use_lit": 101, "streamlin": 101, "give": 101, "compat": 101, "swa_util": 101, "l66": 101, "entail": 101, "exponenti": 101, "decai": 101, "ignor": 101, "somewai": 101, "lit": 101, "adjust": 101, "small": 101, "approach": 101, "nproc": 102, "launchconfig": 102, "pet": 102, "launch_config": 102, "elastic_launch": 102, "interpret": [103, 104], "asan": [103, 105], "tsan": 104, "func": 105, "lower_bound": 106, "upper_bound": 106, "recorded_dur": [106, 108, 109, 110, 112], "size_bound": [106, 108], "lower": [106, 108], "upper": [106, 108], "bound": [106, 108], "smaller": [106, 108], "remov": [106, 108], "action": [106, 108, 110, 112, 113, 114], "cuda_sync": [106, 108, 115], "verbos": [106, 108], "incur": [106, 108], "hit": [106, 108], "accur": [106, 108, 115], "cpu_pg": 107, "propag": 107, "previou": 107, "block": 107, "percentil": [110, 112, 113], "sequenc": [110, 112, 113], "whose": 113, "action_nam": 115, "progress_bar": [116, 118], "tqdm_asyncio": [116, 117, 118], "desc": 117, "far": 117, "he": 117, "reflect": 118, "runtim": [119, 120], "Is": 121}, "objects": {"torchtnt.framework.auto_unit": [[3, 0, 1, "", "AutoPredictUnit"], [3, 0, 1, "", "AutoUnit"]], "torchtnt.framework.auto_unit.AutoPredictUnit": [[3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "predict_step"]], "torchtnt.framework.auto_unit.AutoUnit": [[3, 1, 1, "", "compute_loss"], [3, 1, 1, "", "configure_optimizers_and_lr_scheduler"], [3, 1, 1, "", "eval_step"], [3, 1, 1, "", "get_next_eval_batch"], [3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "get_next_train_batch"], [3, 1, 1, "", "on_eval_step_end"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "on_train_epoch_end"], [3, 1, 1, "", "on_train_step_end"], [3, 1, 1, "", "predict_step"], [3, 1, 1, "", "train_step"]], "torchtnt.framework": [[4, 2, 0, "-", "callback"]], "torchtnt.framework.callback": [[4, 0, 1, "", "Callback"]], "torchtnt.framework.callback.Callback": [[4, 3, 1, "", "name"], [4, 1, 1, "", "on_eval_end"], [4, 1, 1, "", "on_eval_epoch_end"], [4, 1, 1, "", "on_eval_epoch_start"], [4, 1, 1, "", "on_eval_get_next_batch_end"], [4, 1, 1, "", "on_eval_start"], [4, 1, 1, "", "on_eval_step_end"], [4, 1, 1, "", "on_eval_step_start"], [4, 1, 1, "", "on_exception"], [4, 1, 1, "", "on_predict_end"], [4, 1, 1, "", "on_predict_epoch_end"], [4, 1, 1, "", "on_predict_epoch_start"], [4, 1, 1, "", "on_predict_get_next_batch_end"], [4, 1, 1, "", "on_predict_start"], [4, 1, 1, "", "on_predict_step_end"], [4, 1, 1, "", "on_predict_step_start"], [4, 1, 1, "", "on_train_end"], [4, 1, 1, "", "on_train_epoch_end"], [4, 1, 1, "", "on_train_epoch_start"], [4, 1, 1, "", "on_train_get_next_batch_end"], [4, 1, 1, "", "on_train_start"], [4, 1, 1, "", "on_train_step_end"], [4, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks": [[7, 0, 1, "", "BaseCSVWriter"], [8, 0, 1, "", "GarbageCollector"], [9, 0, 1, "", "IterationTimeLogger"], [10, 0, 1, "", "Lambda"], [11, 0, 1, "", "LearningRateMonitor"], [12, 0, 1, "", "MemorySnapshot"], [13, 0, 1, "", "ModuleSummary"], [14, 0, 1, "", "PyTorchProfiler"], [15, 0, 1, "", "SystemResourcesMonitor"], [16, 0, 1, "", "TQDMProgressBar"], [17, 0, 1, "", "TensorBoardParameterMonitor"], [18, 0, 1, "", "TimeLimitInterrupter"], [19, 0, 1, "", "TorchSnapshotSaver"], [20, 0, 1, "", "TrainProgressMonitor"]], "torchtnt.framework.callbacks.BaseCSVWriter": [[7, 1, 1, "", "on_exception"], [7, 1, 1, "", "on_predict_end"], [7, 1, 1, "", "on_predict_start"], [7, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.GarbageCollector": [[8, 1, 1, "", "on_eval_end"], [8, 1, 1, "", "on_eval_start"], [8, 1, 1, "", "on_eval_step_end"], [8, 1, 1, "", "on_predict_end"], [8, 1, 1, "", "on_predict_start"], [8, 1, 1, "", "on_predict_step_end"], [8, 1, 1, "", "on_train_end"], [8, 1, 1, "", "on_train_start"], [8, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.IterationTimeLogger": [[9, 1, 1, "", "on_eval_step_end"], [9, 1, 1, "", "on_predict_step_end"], [9, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.LearningRateMonitor": [[11, 1, 1, "", "on_train_epoch_start"], [11, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.MemorySnapshot": [[12, 1, 1, "", "on_eval_step_end"], [12, 1, 1, "", "on_predict_step_end"], [12, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.ModuleSummary": [[13, 1, 1, "", "on_eval_start"], [13, 1, 1, "", "on_predict_start"], [13, 1, 1, "", "on_train_start"]], "torchtnt.framework.callbacks.PyTorchProfiler": [[14, 1, 1, "", "on_eval_end"], [14, 1, 1, "", "on_eval_start"], [14, 1, 1, "", "on_eval_step_end"], [14, 1, 1, "", "on_predict_end"], [14, 1, 1, "", "on_predict_start"], [14, 1, 1, "", "on_predict_step_end"], [14, 1, 1, "", "on_train_end"], [14, 1, 1, "", "on_train_start"], [14, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SystemResourcesMonitor": [[15, 1, 1, "", "on_eval_epoch_start"], [15, 1, 1, "", "on_eval_step_start"], [15, 1, 1, "", "on_predict_epoch_start"], [15, 1, 1, "", "on_predict_step_start"], [15, 1, 1, "", "on_train_epoch_start"], [15, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.TQDMProgressBar": [[16, 1, 1, "", "on_eval_epoch_end"], [16, 1, 1, "", "on_eval_epoch_start"], [16, 1, 1, "", "on_eval_step_end"], [16, 1, 1, "", "on_predict_epoch_end"], [16, 1, 1, "", "on_predict_epoch_start"], [16, 1, 1, "", "on_predict_step_end"], [16, 1, 1, "", "on_train_epoch_end"], [16, 1, 1, "", "on_train_epoch_start"], [16, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TensorBoardParameterMonitor": [[17, 1, 1, "", "on_train_epoch_end"]], "torchtnt.framework.callbacks.TimeLimitInterrupter": [[18, 1, 1, "", "on_train_epoch_end"], [18, 1, 1, "", "on_train_start"], [18, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[19, 1, 1, "", "on_exception"], [19, 1, 1, "", "on_train_start"], [19, 1, 1, "", "restore"]], "torchtnt.framework.callbacks.TrainProgressMonitor": [[20, 1, 1, "", "on_train_epoch_end"], [20, 1, 1, "", "on_train_start"]], "torchtnt.framework.evaluate": [[5, 4, 1, "", "evaluate"]], "torchtnt.framework.fit": [[6, 4, 1, "", "fit"]], "torchtnt.framework.predict": [[21, 4, 1, "", "predict"]], "torchtnt.framework.state": [[22, 0, 1, "", "PhaseState"], [22, 0, 1, "", "State"]], "torchtnt.framework.state.PhaseState": [[22, 3, 1, "", "dataloader"], [22, 3, 1, "", "evaluate_every_n_epochs"], [22, 3, 1, "", "evaluate_every_n_steps"], [22, 3, 1, "", "iteration_timer"], [22, 3, 1, "", "max_epochs"], [22, 3, 1, "", "max_steps"], [22, 3, 1, "", "max_steps_per_epoch"], [22, 3, 1, "", "step_output"]], "torchtnt.framework.state.State": [[22, 3, 1, "", "active_phase"], [22, 3, 1, "", "entry_point"], [22, 3, 1, "", "eval_state"], [22, 3, 1, "", "predict_state"], [22, 3, 1, "", "should_stop"], [22, 1, 1, "", "stop"], [22, 3, 1, "", "timer"], [22, 3, 1, "", "train_state"]], "torchtnt.framework.train": [[23, 4, 1, "", "train"]], "torchtnt.framework.unit": [[24, 0, 1, "", "EvalUnit"], [24, 0, 1, "", "PredictUnit"], [24, 0, 1, "", "TrainUnit"]], "torchtnt.framework.unit.EvalUnit": [[24, 1, 1, "", "eval_step"], [24, 1, 1, "", "get_next_eval_batch"], [24, 1, 1, "", "on_eval_end"], [24, 1, 1, "", "on_eval_epoch_end"], [24, 1, 1, "", "on_eval_epoch_start"], [24, 1, 1, "", "on_eval_start"]], "torchtnt.framework.unit.PredictUnit": [[24, 1, 1, "", "get_next_predict_batch"], [24, 1, 1, "", "on_predict_end"], [24, 1, 1, "", "on_predict_epoch_end"], [24, 1, 1, "", "on_predict_epoch_start"], [24, 1, 1, "", "on_predict_start"], [24, 1, 1, "", "predict_step"]], "torchtnt.framework.unit.TrainUnit": [[24, 1, 1, "", "get_next_train_batch"], [24, 1, 1, "", "on_train_end"], [24, 1, 1, "", "on_train_epoch_end"], [24, 1, 1, "", "on_train_epoch_start"], [24, 1, 1, "", "on_train_start"], [24, 1, 1, "", "train_step"]], "torchtnt.utils.data": [[27, 0, 1, "", "AbstractRandomDataset"], [28, 0, 1, "", "AllDatasetBatchesIterator"], [29, 0, 1, "", "CudaDataPrefetcher"], [30, 0, 1, "", "InOrderIterator"], [31, 0, 1, "", "MultiDataLoader"], [32, 0, 1, "", "MultiIterator"], [33, 0, 1, "", "RandomizedBatchSamplerIterator"], [34, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.AbstractRandomDataset": [[27, 1, 1, "", "__init__"], [27, 5, 1, "", "size"]], "torchtnt.utils.data.AllDatasetBatchesIterator": [[28, 1, 1, "", "__init__"]], "torchtnt.utils.data.CudaDataPrefetcher": [[29, 1, 1, "", "__init__"]], "torchtnt.utils.data.InOrderIterator": [[30, 1, 1, "", "__init__"]], "torchtnt.utils.data.MultiDataLoader": [[31, 1, 1, "", "__init__"], [31, 5, 1, "", "ignore_empty_data"], [31, 5, 1, "", "individual_dataloaders"], [31, 5, 1, "", "iteration_strategy"], [31, 5, 1, "", "iterator_cls"]], "torchtnt.utils.data.MultiIterator": [[32, 1, 1, "", "__init__"]], "torchtnt.utils.data.RandomizedBatchSamplerIterator": [[33, 1, 1, "", "__init__"]], "torchtnt.utils.data.RoundRobinIterator": [[34, 1, 1, "", "__init__"]], "torchtnt.utils.device": [[35, 4, 1, "", "copy_data_to_device"], [36, 4, 1, "", "get_device_from_env"], [37, 4, 1, "", "get_nvidia_smi_gpu_stats"], [38, 4, 1, "", "get_psutil_cpu_stats"], [39, 4, 1, "", "record_data_in_stream"], [40, 4, 1, "", "set_float32_precision"]], "torchtnt.utils.distributed": [[41, 0, 1, "", "PGWrapper"], [42, 4, 1, "", "all_gather_tensors"], [43, 4, 1, "", "barrier"], [44, 4, 1, "", "destroy_process_group"], [45, 4, 1, "", "get_file_init_method"], [46, 4, 1, "", "get_global_rank"], [47, 4, 1, "", "get_local_rank"], [48, 4, 1, "", "get_process_group_backend_from_device"], [49, 4, 1, "", "get_tcp_init_method"], [50, 4, 1, "", "get_world_size"], [51, 4, 1, "", "rank_zero_fn"], [52, 4, 1, "", "revert_sync_batchnorm"], [53, 4, 1, "", "spawn_multi_process"], [54, 4, 1, "", "sync_bool"]], "torchtnt.utils.distributed.PGWrapper": [[41, 1, 1, "", "__init__"]], "torchtnt.utils.early_stop_checker": [[55, 0, 1, "", "EarlyStopChecker"]], "torchtnt.utils.early_stop_checker.EarlyStopChecker": [[55, 1, 1, "", "__init__"]], "torchtnt.utils.env": [[56, 4, 1, "", "init_from_env"], [57, 4, 1, "", "seed"]], "torchtnt.utils.flops": [[58, 0, 1, "", "FlopTensorDispatchMode"]], "torchtnt.utils.flops.FlopTensorDispatchMode": [[58, 1, 1, "", "__init__"]], "torchtnt.utils.fsspec": [[59, 4, 1, "", "get_filesystem"]], "torchtnt.utils.loggers": [[60, 0, 1, "", "CSVLogger"], [61, 0, 1, "", "FileLogger"], [62, 0, 1, "", "InMemoryLogger"], [63, 0, 1, "", "JSONLogger"], [64, 0, 1, "", "MetricLogger"], [65, 0, 1, "", "StdoutLogger"], [66, 0, 1, "", "TensorBoardLogger"]], "torchtnt.utils.loggers.CSVLogger": [[60, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.FileLogger": [[61, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.InMemoryLogger": [[62, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.JSONLogger": [[63, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.MetricLogger": [[64, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.StdoutLogger": [[65, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.TensorBoardLogger": [[66, 1, 1, "", "__init__"]], "torchtnt.utils.memory": [[67, 0, 1, "", "RSSProfiler"], [68, 4, 1, "", "measure_rss_deltas"]], "torchtnt.utils.memory.RSSProfiler": [[67, 1, 1, "", "__init__"], [67, 5, 1, "", "interval"], [67, 5, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.memory_snapshot_profiler": [[69, 0, 1, "", "MemorySnapshotProfiler"]], "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler": [[69, 1, 1, "", "__init__"]], "torchtnt.utils.misc": [[70, 4, 1, "", "days_to_secs"], [71, 4, 1, "", "transfer_batch_norm_stats"]], "torchtnt.utils.module_summary": [[72, 0, 1, "", "ModuleSummary"], [73, 4, 1, "", "get_module_summary"], [74, 4, 1, "", "get_summary_table"], [75, 4, 1, "", "prune_module_summary"]], "torchtnt.utils.module_summary.ModuleSummary": [[72, 1, 1, "", "__init__"]], "torchtnt.utils.oom": [[76, 4, 1, "", "attach_oom_observer"], [77, 4, 1, "", "is_out_of_cpu_memory"], [78, 4, 1, "", "is_out_of_cuda_memory"], [79, 4, 1, "", "is_out_of_memory_error"], [80, 4, 1, "", "log_memory_snapshot"]], "torchtnt.utils.optimizer": [[81, 4, 1, "", "init_optim_state"]], "torchtnt.utils.precision": [[82, 4, 1, "", "convert_precision_str_to_dtype"]], "torchtnt.utils.prepare_module": [[83, 0, 1, "", "DDPStrategy"], [84, 0, 1, "", "FSDPStrategy"], [85, 4, 1, "", "convert_str_to_strategy"], [86, 4, 1, "", "prepare_ddp"], [87, 4, 1, "", "prepare_fsdp"], [88, 4, 1, "", "prepare_module"]], "torchtnt.utils.prepare_module.DDPStrategy": [[83, 1, 1, "", "__init__"]], "torchtnt.utils.prepare_module.FSDPStrategy": [[84, 1, 1, "", "__init__"]], "torchtnt.utils.progress": [[89, 0, 1, "", "Progress"], [90, 4, 1, "", "estimated_steps_in_epoch"], [91, 4, 1, "", "estimated_steps_in_fit"], [92, 4, 1, "", "estimated_steps_in_loop"]], "torchtnt.utils.progress.Progress": [[89, 1, 1, "", "__init__"]], "torchtnt.utils.rank_zero_log": [[93, 4, 1, "", "rank_zero_critical"], [94, 4, 1, "", "rank_zero_debug"], [95, 4, 1, "", "rank_zero_error"], [96, 4, 1, "", "rank_zero_info"], [97, 4, 1, "", "rank_zero_print"], [98, 4, 1, "", "rank_zero_warn"]], "torchtnt.utils.stateful": [[99, 0, 1, "", "MultiStateful"], [100, 0, 1, "", "Stateful"]], "torchtnt.utils.stateful.MultiStateful": [[99, 1, 1, "", "__init__"]], "torchtnt.utils.stateful.Stateful": [[100, 1, 1, "", "__init__"]], "torchtnt.utils.swa": [[101, 0, 1, "", "AveragedModel"]], "torchtnt.utils.swa.AveragedModel": [[101, 1, 1, "", "__init__"]], "torchtnt.utils.test_utils": [[102, 4, 1, "", "get_pet_launch_config"], [103, 4, 1, "", "is_asan"], [104, 4, 1, "", "is_tsan"], [105, 4, 1, "", "skip_if_asan"]], "torchtnt.utils.timer": [[106, 0, 1, "", "BoundedTimer"], [107, 0, 1, "", "FullSyncPeriodicTimer"], [108, 0, 1, "", "Timer"], [109, 0, 1, "", "TimerProtocol"], [110, 4, 1, "", "get_durations_histogram"], [111, 4, 1, "", "get_recorded_durations_table"], [112, 4, 1, "", "get_synced_durations_histogram"], [113, 4, 1, "", "get_synced_timer_histogram"], [114, 4, 1, "", "get_timer_summary"], [115, 4, 1, "", "log_elapsed_time"]], "torchtnt.utils.timer.BoundedTimer": [[106, 1, 1, "", "__init__"]], "torchtnt.utils.timer.FullSyncPeriodicTimer": [[107, 1, 1, "", "__init__"]], "torchtnt.utils.timer.Timer": [[108, 1, 1, "", "__init__"]], "torchtnt.utils.timer.TimerProtocol": [[109, 1, 1, "", "__init__"]], "torchtnt.utils.tqdm": [[116, 4, 1, "", "close_progress_bar"], [117, 4, 1, "", "create_progress_bar"], [118, 4, 1, "", "update_progress_bar"]], "torchtnt.utils.version": [[119, 4, 1, "", "get_python_version"], [120, 4, 1, "", "get_torch_version"], [121, 4, 1, "", "is_windows"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:module", "3": "py:property", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "module", "Python module"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"checkpoint": 0, "fulli": [0, 1], "shard": [0, 1], "data": [0, 1, 27, 28, 29, 30, 31, 32, 33, 34, 122], "parallel": [0, 1], "finetun": 0, "best": 0, "model": [0, 26], "metric": 0, "distribut": [1, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 122], "train": [1, 2, 23, 26], "exampl": [2, 25], "trainunit": [2, 24], "autounit": [2, 3], "torchdata": 2, "mnist": 2, "mingpt": 2, "torchrec": 2, "callback": [4, 26], "built": 4, "evalu": 5, "entri": [5, 6, 21, 23], "point": [5, 6, 21, 23], "fit": 6, "basecsvwrit": 7, "garbagecollector": 8, "iterationtimelogg": 9, "lambda": 10, "learningratemonitor": 11, "memorysnapshot": 12, "modulesummari": [13, 72], "pytorchprofil": 14, "systemresourcesmonitor": 15, "tqdmprogressbar": 16, "tensorboardparametermonitor": 17, "timelimitinterrupt": 18, "torchsnapshotsav": 19, "trainprogressmonitor": 20, "predict": 21, "state": [22, 99, 100, 122], "phasest": 22, "unit": 24, "evalunit": 24, "predictunit": 24, "combin": 24, "multipl": 24, "welcom": 25, "torchtnt": [25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121], "document": 25, "instal": 25, "overview": [25, 26], "core": [25, 26], "concept": 25, "framework": [25, 26], "util": [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122], "function": 26, "api": 26, "organ": 26, "your": 26, "code": 26, "abstractrandomdataset": 27, "alldatasetbatchesiter": 28, "cudadataprefetch": 29, "inorderiter": 30, "multidataload": 31, "multiiter": 32, "randomizedbatchsampleriter": 33, "roundrobiniter": 34, "devic": [35, 36, 37, 38, 39, 40, 122], "copy_data_to_devic": 35, "get_device_from_env": 36, "get_nvidia_smi_gpu_stat": 37, "get_psutil_cpu_stat": 38, "record_data_in_stream": 39, "set_float32_precis": 40, "pgwrapper": 41, "all_gather_tensor": 42, "barrier": 43, "destroy_process_group": 44, "get_file_init_method": 45, "get_global_rank": 46, "get_local_rank": 47, "get_process_group_backend_from_devic": 48, "get_tcp_init_method": 49, "get_world_s": 50, "rank_zero_fn": 51, "revert_sync_batchnorm": 52, "spawn_multi_process": 53, "sync_bool": 54, "early_stop_check": 55, "earlystopcheck": 55, "env": [56, 57], "init_from_env": 56, "seed": 57, "flop": [58, 122], "floptensordispatchmod": 58, "fsspec": 59, "get_filesystem": 59, "logger": [60, 61, 62, 63, 64, 65, 66, 122], "csvlogger": 60, "filelogg": 61, "inmemorylogg": 62, "jsonlogg": 63, "metriclogg": 64, "stdoutlogg": 65, "tensorboardlogg": 66, "memori": [67, 68, 122], "rssprofil": 67, "measure_rss_delta": 68, "memory_snapshot_profil": 69, "memorysnapshotprofil": [69, 122], "misc": [70, 71, 122], "days_to_sec": 70, "transfer_batch_norm_stat": 71, "module_summari": [72, 73, 74, 75], "get_module_summari": 73, "get_summary_t": 74, "prune_module_summari": 75, "oom": [76, 77, 78, 79, 80, 122], "attach_oom_observ": 76, "is_out_of_cpu_memori": 77, "is_out_of_cuda_memori": 78, "is_out_of_memory_error": 79, "log_memory_snapshot": 80, "optim": [81, 122], "init_optim_st": 81, "precis": [82, 122], "convert_precision_str_to_dtyp": 82, "prepare_modul": [83, 84, 85, 86, 87, 88], "ddpstrategi": 83, "fsdpstrategi": 84, "convert_str_to_strategi": 85, "prepare_ddp": 86, "prepare_fsdp": 87, "progress": [89, 90, 91, 92, 122], "estimated_steps_in_epoch": 90, "estimated_steps_in_fit": 91, "estimated_steps_in_loop": 92, "rank_zero_log": [93, 94, 95, 96, 97, 98], "rank_zero_crit": 93, "rank_zero_debug": 94, "rank_zero_error": 95, "rank_zero_info": 96, "rank_zero_print": 97, "rank_zero_warn": 98, "multist": 99, "swa": [101, 122], "averagedmodel": 101, "test_util": [102, 103, 104, 105], "get_pet_launch_config": 102, "is_asan": 103, "is_tsan": 104, "skip_if_asan": 105, "timer": [106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 122], "boundedtim": 106, "fullsyncperiodictim": 107, "timerprotocol": 109, "get_durations_histogram": 110, "get_recorded_durations_t": 111, "get_synced_durations_histogram": 112, "get_synced_timer_histogram": 113, "get_timer_summari": 114, "log_elapsed_tim": 115, "tqdm": [116, 117, 118, 122], "close_progress_bar": 116, "create_progress_bar": 117, "update_progress_bar": 118, "version": [119, 120, 121, 122], "get_python_vers": 119, "get_torch_vers": 120, "is_window": 121, "earli": 122, "stop": 122, "checker": 122, "environ": 122, "filesystem": 122, "spec": 122, "modul": 122, "summari": 122, "prepar": 122, "rank": 122, "zero": 122, "log": 122, "test": 122}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 56}})